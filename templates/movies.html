{% extends "base.html" %}

{% block content %}
    <h1>Movies for {{ user.name }}</h1>

    <ul class="movie-list">
        {% for movie in movies %}
            <li class="movie-entry">
                {{ movie.name }}
                {% if movie.year %}
                    ({{ movie.year }})
                {% endif %}

                {% if movie.director %}
                    <div>Directed by: {{ movie.director }}</div>
                {% endif %}

                {% if movie.poster_url %}
                    <img src="{{ movie.poster_url }}" alt="{{ movie.name }} poster" class="poster">
                {% endif %}

                <form action="{{ url_for('update_movie', user_id=user.id, movie_id=movie.id) }}" method="post" class="inline-form">
                    <input type="text" name="new_title" placeholder="New title">
                    <input type="number" name="new_year" placeholder="Year">
                    <input type="text" name="new_director" placeholder="Director">
                    <button type="submit">Update</button>
                </form>

                <form action="{{ url_for('delete_movie', user_id=user.id, movie_id=movie.id) }}"
                      method="post"
                      class="inline-form">
                    <button type="submit">Delete</button>
                </form>
            </li>

        {% else %}
            <li>No movies yet. Add one below!</li>
        {% endfor %}
    </ul>

    <h2>Add new movie</h2>
    <form action="{{ url_for('add_movie', user_id=user.id) }}" method="post">
        <input type="text" name="title" placeholder="Enter movie title" required>
        <button type="submit">Add movie</button>
    </form>

    <p><a href="{{ url_for('index') }}">Back to users</a></p>
{% endblock %}
